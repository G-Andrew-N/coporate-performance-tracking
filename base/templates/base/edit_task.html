{% extends 'main.html' %}

{% block content %}
    <h1>Edit Task</h1>

    <!-- Display Messages -->
    {% if messages %}
        <div class="messages">
            {% for message in messages %}
                <div class="{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Edit Task Form -->
    <form method="post">
        {% csrf_token %}
        <label for="predefined_task">Select Task:</label>
        <select name="predefined_task_id" id="predefined_task" required>
            <option value="" disabled>Select a task</option>
            {% for task in predefined_tasks %}
                <option value="{{ task.id }}" {% if task.id == task.predefined_task.id %}selected{% endif %}>
                    {{ task.title }}
                </option>
            {% endfor %}
        </select>

        <label for="employee">Assign to Agent:</label>
        <select name="employee_id" id="employee" required>
            <option value="" disabled>Select an agent</option>
            {% for agent in agents %}
                <option value="{{ agent.id }}" {% if agent.id == task.assigned_to.id %}selected{% endif %}>
                    {{ agent.user.get_full_name }}
                </option>
            {% endfor %}
        </select>

        <label for="due_date">Due Date:</label>
        <input type="date" name="due_date" id="due_date" value="{{ task.due_date|date:'Y-m-d' }}" required>

        <label for="status">Status:</label>
        <select name="status" id="status" required>
            <option value="Pending" {% if task.status == 'Pending' %}selected{% endif %}>Pending</option>
            <option value="In Progress" {% if task.status == 'In Progress' %}selected{% endif %}>In Progress</option>
            <option value="Completed" {% if task.status == 'Completed' %}selected{% endif %}>Completed</option>
        </select>

        <button type="submit">Update Task</button>
    </form>
{%endblock%}